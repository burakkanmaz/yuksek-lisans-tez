# CWE-611 - Improper Restriction of XML External Entity Reference
<a href="https://cwe.mitre.org/data/definitions/611.html" target="_blank">ğŸ”— CWE-611 - Improper Restriction of XML External Entity Reference</a>

## âœï¸ Senaryo 1
Bir belge doÄŸrulama sistemi, kullanÄ±cÄ±dan XML formatÄ±nda baÅŸvuru dosyalarÄ± alÄ±yor. Bu dosyalar sunucu tarafÄ±nda parse edilerek bilgileri kontrol ediliyor. Uygulama XML iÃ§eriÄŸini olduÄŸu gibi iÅŸlerken, dÄ±ÅŸ kaynaklara yapÄ±lan referanslarÄ± sÄ±nÄ±rlandÄ±rmÄ±yor.

## âœï¸ Senaryo 2
Bir e-fatura sistemi, yÃ¼klenen XML dosyalarÄ±nÄ± sistemdeki mevcut kayÄ±tlarla karÅŸÄ±laÅŸtÄ±rÄ±yor. Dosya iÃ§eriÄŸi ayrÄ±ÅŸtÄ±rÄ±lÄ±rken, dosyada tanÄ±mlÄ± tÃ¼m entity referanslarÄ± doÄŸrudan Ã§Ã¶zÃ¼lÃ¼yor. Bu iÅŸlem sÄ±rasÄ±nda dÄ±ÅŸ kaynaklara yÃ¶nlendirme yapÄ±lmasÄ±na izin veriliyor.

## âœï¸ Senaryo 3
Bir form iÅŸleme uygulamasÄ±, kullanÄ±cÄ±dan gelen XML verilerini alarak bir PDF dosyasÄ±na dÃ¶nÃ¼ÅŸtÃ¼rÃ¼yor. XML verisi parse edilirken iÃ§erdiÄŸi external entity tanÄ±mlarÄ±na Ã¶zel bir iÅŸlem uygulanmÄ±yor. BÃ¶ylece dosya iÃ§erisinden dÄ±ÅŸ aÄŸ eriÅŸimi mÃ¼mkÃ¼n hale geliyor.

## âœï¸ Senaryo 4
Bir sigorta baÅŸvuru sistemi, gelen baÅŸvurular XML olarak iletiliyor ve sistem bu verileri arka planda yorumlayarak veri tabanÄ±na kaydediyor. XML Ã§Ã¶zÃ¼mlemesi sÄ±rasÄ±nda dÄ±ÅŸ dosya veya sistem referanslarÄ± engellenmiyor. Bu da istenmeyen sistem iÃ§i dosya eriÅŸimlerine neden olabiliyor.

## âœï¸ Senaryo 5
Bir yazÄ±lÄ±m test platformu, XML formatÄ±nda test senaryolarÄ± alÄ±yor ve bu senaryolarÄ± test motoruna gÃ¶nderiyor. XML parser, iÃ§erik kontrolÃ¼ yapmadan gelen referanslarÄ± doÄŸrudan iÅŸliyor. Bu iÅŸlemle birlikte uzaktaki bir URL'den veri Ã§ekilebiliyor.

## âœï¸ Senaryo 6
Bir kullanÄ±cÄ± verisi iÃ§eren XML dosyasÄ±, iÃ§e aktarma Ã¶zelliÄŸi sayesinde sisteme yÃ¼klenebiliyor. Bu dosya iÃ§inde tanÄ±mlanmÄ±ÅŸ external entity referanslarÄ± olduÄŸunda, sistem bu referanslarÄ± Ã§alÄ±ÅŸtÄ±rÄ±yor. BÃ¶ylece beklenmedik dosya eriÅŸimi yaÅŸanabiliyor.

## âœï¸ Senaryo 7
Bir mÃ¼ÅŸteri kayÄ±t uygulamasÄ±, XML olarak gelen adres bilgilerini alÄ±yor ve adres doÄŸrulama servislerine gÃ¶nderiyor. Gelen XML dosyasÄ±ndaki entity referanslarÄ± doÄŸrulanmadan iÅŸleniyor. Bu durum, uygulamanÄ±n dÄ±ÅŸ aÄŸlara baÄŸlantÄ± kurmasÄ±na neden olabiliyor.

## âœï¸ Senaryo 8
Bir API sistemi, XML iÃ§eren POST isteklerini kabul ederek iÃ§eriÄŸi ayrÄ±ÅŸtÄ±rÄ±yor. XML Ã§Ã¶zÃ¼mleme iÅŸlemi sÄ±rasÄ±nda herhangi bir gÃ¼venlik politikasÄ± uygulanmÄ±yor. KullanÄ±cÄ± tarafÄ±ndan gÃ¶nderilen iÃ§erikte dÄ±ÅŸ referanslar varsa sistem bunlara istek gÃ¶nderebiliyor.

## âœï¸ Senaryo 9
Bir katalog yÃ¶netim aracÄ±, XML ile gelen Ã¼rÃ¼n listelerini iÃ§e aktarÄ±yor. XML belgeleri iÃ§inde bulunan dÄ±ÅŸ kaynak tanÄ±mlarÄ± Ã§Ã¶zÃ¼lmeden iÅŸleniyor. Bu da uygulamanÄ±n dÄ±ÅŸ sunuculara baÄŸlanmasÄ±na neden olabiliyor.

## âœï¸ Senaryo 10
Bir HR uygulamasÄ±, Ã§alÄ±ÅŸan bilgilerini XML formatÄ±nda alarak sisteme kaydediyor. XML'de yer alan external entity tanÄ±mlarÄ± sistem tarafÄ±ndan yorumlanÄ±yor. BÃ¶ylece XML Ã¼zerinden sistem iÃ§i dosya iÃ§erikleri dÄ±ÅŸa sÄ±zdÄ±rÄ±labiliyor.

