# CWE-611 - Improper Restriction of XML External Entity Reference
<a href="https://cwe.mitre.org/data/definitions/611.html" target="_blank">🔗 CWE-611 - Improper Restriction of XML External Entity Reference</a>

## ✏️ Senaryo 1
Bir belge doğrulama sistemi, kullanıcıdan XML formatında başvuru dosyaları alıyor. Bu dosyalar sunucu tarafında parse edilerek bilgileri kontrol ediliyor. Uygulama XML içeriğini olduğu gibi işlerken, dış kaynaklara yapılan referansları sınırlandırmıyor.

## ✏️ Senaryo 2
Bir e-fatura sistemi, yüklenen XML dosyalarını sistemdeki mevcut kayıtlarla karşılaştırıyor. Dosya içeriği ayrıştırılırken, dosyada tanımlı tüm entity referansları doğrudan çözülüyor. Bu işlem sırasında dış kaynaklara yönlendirme yapılmasına izin veriliyor.

## ✏️ Senaryo 3
Bir form işleme uygulaması, kullanıcıdan gelen XML verilerini alarak bir PDF dosyasına dönüştürüyor. XML verisi parse edilirken içerdiği external entity tanımlarına özel bir işlem uygulanmıyor. Böylece dosya içerisinden dış ağ erişimi mümkün hale geliyor.

## ✏️ Senaryo 4
Bir sigorta başvuru sistemi, gelen başvurular XML olarak iletiliyor ve sistem bu verileri arka planda yorumlayarak veri tabanına kaydediyor. XML çözümlemesi sırasında dış dosya veya sistem referansları engellenmiyor. Bu da istenmeyen sistem içi dosya erişimlerine neden olabiliyor.

## ✏️ Senaryo 5
Bir yazılım test platformu, XML formatında test senaryoları alıyor ve bu senaryoları test motoruna gönderiyor. XML parser, içerik kontrolü yapmadan gelen referansları doğrudan işliyor. Bu işlemle birlikte uzaktaki bir URL'den veri çekilebiliyor.

## ✏️ Senaryo 6
Bir kullanıcı verisi içeren XML dosyası, içe aktarma özelliği sayesinde sisteme yüklenebiliyor. Bu dosya içinde tanımlanmış external entity referansları olduğunda, sistem bu referansları çalıştırıyor. Böylece beklenmedik dosya erişimi yaşanabiliyor.

## ✏️ Senaryo 7
Bir müşteri kayıt uygulaması, XML olarak gelen adres bilgilerini alıyor ve adres doğrulama servislerine gönderiyor. Gelen XML dosyasındaki entity referansları doğrulanmadan işleniyor. Bu durum, uygulamanın dış ağlara bağlantı kurmasına neden olabiliyor.

## ✏️ Senaryo 8
Bir API sistemi, XML içeren POST isteklerini kabul ederek içeriği ayrıştırıyor. XML çözümleme işlemi sırasında herhangi bir güvenlik politikası uygulanmıyor. Kullanıcı tarafından gönderilen içerikte dış referanslar varsa sistem bunlara istek gönderebiliyor.

## ✏️ Senaryo 9
Bir katalog yönetim aracı, XML ile gelen ürün listelerini içe aktarıyor. XML belgeleri içinde bulunan dış kaynak tanımları çözülmeden işleniyor. Bu da uygulamanın dış sunuculara bağlanmasına neden olabiliyor.

## ✏️ Senaryo 10
Bir HR uygulaması, çalışan bilgilerini XML formatında alarak sisteme kaydediyor. XML'de yer alan external entity tanımları sistem tarafından yorumlanıyor. Böylece XML üzerinden sistem içi dosya içerikleri dışa sızdırılabiliyor.

