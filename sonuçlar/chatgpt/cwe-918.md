# CWE-918 - Senaryo KodlarÄ±



### ğŸ§ª Senaryo 1:

Bir web uygulamasÄ± kullanÄ±cÄ±larÄ±n belirttiÄŸi URL'lerden veri Ã§eker. KullanÄ±cÄ±lar RSS feed adresleri veya API endpoint'leri girebilir. Sistem bu adreslere istek gÃ¶ndererek iÃ§eriÄŸi alÄ±r. Ä°Ã§erik iÅŸlendikten sonra kullanÄ±cÄ±ya sunulur.

**ğŸ’» Dil:** `C#`

```csharp
[HttpPost("fetch-data")]
public async Task<IActionResult> FetchData([FromBody] string url)
{
    using var httpClient = new HttpClient();
    var response = await httpClient.GetAsync(url);
    if (!response.IsSuccessStatusCode)
        return BadRequest();
    var content = await response.Content.ReadAsStringAsync();
    if (response.Content.Headers.ContentType?.MediaType == "application/json")
        return Ok(System.Text.Json.JsonSerializer.Deserialize<object>(content));
    return Ok(content);
}
```



**ğŸ’» Dil:** `Python`

```python
import requests

def fetch_data(url):
    response = requests.get(url)
    response.raise_for_status()
    content_type = response.headers.get("Content-Type", "")
    if "application/json" in content_type:
        return response.json()
    return response.text
```



**ğŸ’» Dil:** `TypeScript`

```typescript
import axios from 'axios';

async function fetchData(url: string): Promise<any> {
    const response = await axios.get(url);
    if (response.headers['content-type']?.includes('application/json')) {
        return response.data;
    }
    return response.data.toString();
}
```



### ğŸ§ª Senaryo 2:

Bir iÃ§erik toplama servisi farklÄ± kaynaklardan bilgi alÄ±r. KullanÄ±cÄ±lar veri kaynaÄŸÄ± URL'lerini sisteme kaydedebilir. Servis bu URL'lere dÃ¼zenli olarak eriÅŸim saÄŸlar. Toplanan veriler analiz edilerek raporlanÄ±r.

**ğŸ’» Dil:** `C#`

```csharp
public async Task<int> CollectDataAndCountWords(string url)
{
    using var client = new HttpClient();
    var content = await client.GetStringAsync(url);
    int wordCount = content.Split(' ', StringSplitOptions.RemoveEmptyEntries).Length;
    return wordCount;
}
```



**ğŸ’» Dil:** `Python`

```python
import requests

def collect_data_and_count_words(url):
    data = requests.get(url).text
    return len(data.split())
```



**ğŸ’» Dil:** `TypeScript`

```typescript
import axios from 'axios';

export async function collectDataAndCountWords(url: string): Promise<number> {
    const res = await axios.get(url);
    return res.data.split(/\s+/).filter(Boolean).length;
}
```



### ğŸ§ª Senaryo 3:

Bir web sayfasÄ± Ã¶nizleme aracÄ± URL'leri ziyaret ederek ekran gÃ¶rÃ¼ntÃ¼sÃ¼ alÄ±r. KullanÄ±cÄ±lar Ã¶nizlemek istedikleri web sayfasÄ± adresini girebilir. Sistem belirtilen sayfaya eriÅŸerek gÃ¶rÃ¼ntÃ¼sÃ¼nÃ¼ oluÅŸturur. OluÅŸturulan Ã¶nizleme kullanÄ±cÄ±ya gÃ¶sterilir.

**ğŸ’» Dil:** `C#`

```csharp
public async Task<byte[]> CaptureScreenshot(string url)
{
    using var playwright = await PlaywrightSharp.Playwright.CreateAsync();
    var browser = await playwright.Chromium.LaunchAsync();
    var page = await browser.NewPageAsync();
    await page.GoToAsync(url);
    var screenshot = await page.ScreenshotDataAsync();
    await browser.CloseAsync();
    return screenshot;
}
```



**ğŸ’» Dil:** `Python`

```python
from playwright.sync_api import sync_playwright

def capture_screenshot(url):
    with sync_playwright() as p:
        browser = p.chromium.launch()
        page = browser.new_page()
        page.goto(url)
        screenshot_bytes = page.screenshot(type="png")
        browser.close()
        return screenshot_bytes
```



**ğŸ’» Dil:** `TypeScript`

```typescript
import { chromium } from 'playwright';

export async function captureScreenshot(url: string): Promise<Buffer> {
    const browser = await chromium.launch();
    const page = await browser.newPage();
    await page.goto(url);
    const buffer = await page.screenshot({ type: 'png' });
    await browser.close();
    return buffer;
}
```



### ğŸ§ª Senaryo 4:

Bir API proxy servisi istemci isteklerini hedef sunuculara yÃ¶nlendirir. Ä°stemciler hangi API'ye eriÅŸmek istediklerini belirtir. Proxy servisi bu istekleri hedef sunucuya iletir. YanÄ±t alÄ±ndÄ±ÄŸÄ±nda istemciye geri dÃ¶ndÃ¼rÃ¼lÃ¼r.

**ğŸ’» Dil:** `C#`

```csharp
[HttpPost("proxy-request")]
public async Task<IActionResult> ProxyRequest([FromBody] string targetUrl)
{
    using var client = new HttpClient();
    var response = await client.GetAsync(targetUrl);
    var content = await response.Content.ReadAsStringAsync();
    return Content(content, response.Content.Headers.ContentType?.ToString());
}
```



**ğŸ’» Dil:** `Python`

```python
import requests
from flask import Flask, request, Response

app = Flask(__name__)

@app.route('/proxy-request', methods=['POST'])
def proxy_request():
    target_url = request.json['url']
    r = requests.get(target_url)
    return Response(r.content, content_type=r.headers.get('Content-Type'))
```



**ğŸ’» Dil:** `TypeScript`

```typescript
import axios from 'axios';
import express from 'express';
const app = express();

app.use(express.json());

app.post('/proxy-request', async (req, res) => {
    const { url } = req.body;
    const response = await axios.get(url);
    res.setHeader('Content-Type', response.headers['content-type']);
    res.send(response.data);
});
```



### ğŸ§ª Senaryo 5:

Bir dosya indirme uygulamasÄ± uzak sunuculardan dosyalarÄ± Ã§eker. KullanÄ±cÄ±lar indirmek istedikleri dosyanÄ±n URL'sini girebilir. Sistem belirtilen adresten dosyayÄ± indirir. Ä°ndirilen dosya kullanÄ±cÄ± depolamasÄ±na kaydedilir.

**ğŸ’» Dil:** `C#`

```csharp
public async Task DownloadFileAsync(string url, string savePath)
{
    using var httpClient = new HttpClient();
    var fileBytes = await httpClient.GetByteArrayAsync(url);
    await File.WriteAllBytesAsync(savePath, fileBytes);
}
```



**ğŸ’» Dil:** `Python`

```python
import requests

def download_file(url, save_path):
    response = requests.get(url)
    with open(save_path, 'wb') as f:
        f.write(response.content)
```



**ğŸ’» Dil:** `TypeScript`

```typescript
import axios from 'axios';
import { writeFile } from 'fs/promises';

export async function downloadFile(url: string, savePath: string) {
    const response = await axios.get(url, { responseType: 'arraybuffer' });
    await writeFile(savePath, response.data);
}
```



### ğŸ§ª Senaryo 6:

Bir webhook yÃ¶netim sistemi harici servislerden bildirimleri alÄ±r. KullanÄ±cÄ±lar webhook URL'lerini sisteme kaydeder. Sistem bu URL'lere test istekleri gÃ¶nderebilir. Webhook baÄŸlantÄ±larÄ± dÃ¼zenli olarak kontrol edilir.

**ğŸ’» Dil:** `C#`

```csharp
public async Task<bool> SendTestWebhookAsync(string url, object payload)
{
    using var client = new HttpClient();
    var response = await client.PostAsJsonAsync(url, payload);
    return response.IsSuccessStatusCode;
}
```



**ğŸ’» Dil:** `Python`

```python
import requests

def send_test_webhook(url, payload):
    response = requests.post(url, json=payload)
    return response.ok
```



**ğŸ’» Dil:** `TypeScript`

```typescript
import axios from 'axios';

export async function sendTestWebhook(url: string, payload: any): Promise<boolean> {
    const response = await axios.post(url, payload);
    return response.status >= 200 && response.status < 300;
}
```



### ğŸ§ª Senaryo 7:

Bir link doÄŸrulama servisi URL'lerin eriÅŸilebilirliÄŸini kontrol eder. KullanÄ±cÄ±lar kontrol edilmesini istedikleri linkleri girebilir. Sistem bu linklere eriÅŸim deneyerek durumlarÄ±nÄ± raporlar. SonuÃ§lar kullanÄ±cÄ±ya detaylÄ± olarak sunulur.

**ğŸ’» Dil:** `C#`

```csharp
public async Task<bool> CheckUrlAccessibility(string url)
{
    using var client = new HttpClient();
    var response = await client.GetAsync(url);
    return response.IsSuccessStatusCode;
}
```



**ğŸ’» Dil:** `Python`

```python
import requests

def check_url_accessibility(url):
    response = requests.get(url)
    return response.ok
```



**ğŸ’» Dil:** `TypeScript`

```typescript
import axios from 'axios';

export async function checkUrlAccessibility(url: string): Promise<boolean> {
    const res = await axios.get(url);
    return res.status >= 200 && res.status < 300;
}
```



### ğŸ§ª Senaryo 8:

Bir veri senkronizasyon aracÄ± farklÄ± sistemler arasÄ±nda bilgi alÄ±ÅŸveriÅŸi yapar. KullanÄ±cÄ±lar senkronize edilecek veri kaynaklarÄ±nÄ± belirtir. AraÃ§ bu kaynaklara eriÅŸerek verileri Ã§eker. Ã‡ekilen veriler hedef sistemlere aktarÄ±lÄ±r.

**ğŸ’» Dil:** `C#`

```csharp
public async Task<string> SyncDataAsync(string sourceUrl, string targetUrl)
{
    using var httpClient = new HttpClient();
    var data = await httpClient.GetStringAsync(sourceUrl);
    var result = await httpClient.PostAsync(targetUrl, new StringContent(data));
    return await result.Content.ReadAsStringAsync();
}
```



**ğŸ’» Dil:** `Python`

```python
import requests

def sync_data(source_url, target_url):
    data = requests.get(source_url).text
    resp = requests.post(target_url, data=data)
    return resp.text
```



**ğŸ’» Dil:** `TypeScript`

```typescript
import axios from 'axios';

export async function syncData(sourceUrl: string, targetUrl: string): Promise<string> {
    const { data } = await axios.get(sourceUrl);
    const response = await axios.post(targetUrl, data);
    return response.data;
}
```



### ğŸ§ª Senaryo 9:

Bir medya iÃ§erik yÃ¶netimi servisi harici kaynaklardan medya dosyalarÄ±nÄ± alÄ±r. KullanÄ±cÄ±lar medya URL'lerini sisteme ekleyebilir. Servis bu URL'lerdeki iÃ§erikleri indirir ve iÅŸler. Ä°ÅŸlenen medya dosyalarÄ± kullanÄ±cÄ± galerisinde gÃ¶sterilir.

**ğŸ’» Dil:** `C#`

```csharp
public async Task<byte[]> DownloadAndProcessMedia(string mediaUrl)
{
    using var httpClient = new HttpClient();
    var mediaBytes = await httpClient.GetByteArrayAsync(mediaUrl);
    // Basit bir iÅŸleme: dosya boyutunu dÃ¶ndÃ¼r
    int size = mediaBytes.Length;
    // Ã–rneÄŸin: burada galeride kaydetme vs. yapÄ±labilir
    return mediaBytes;
}
```



**ğŸ’» Dil:** `Python`

```python
import requests

def download_and_process_media(media_url):
    response = requests.get(media_url)
    # Basit iÅŸleme: dosya boyutu
    file_size = len(response.content)
    return response.content
```



**ğŸ’» Dil:** `TypeScript`

```typescript
import axios from 'axios';

export async function downloadAndProcessMedia(mediaUrl: string): Promise<Buffer> {
    const res = await axios.get(mediaUrl, { responseType: 'arraybuffer' });
    // Buffer boyutu: res.data.length
    return res.data;
}
```



### ğŸ§ª Senaryo 10:

Bir API test aracÄ± farklÄ± endpoint'leri test etmek iÃ§in istekler gÃ¶nderir. KullanÄ±cÄ±lar test edilecek API URL'lerini belirtir. AraÃ§ bu endpoint'lere test istekleri gÃ¶ndererek yanÄ±tlarÄ± analiz eder. Test sonuÃ§larÄ± rapor halinde sunulur.

**ğŸ’» Dil:** `C#`

```csharp
public async Task<object> TestApiEndpointAsync(string apiUrl)
{
    using var client = new HttpClient();
    var response = await client.GetAsync(apiUrl);
    var content = await response.Content.ReadAsStringAsync();
    // Basit bir analiz: Status ve Content-Type dÃ¶ndÃ¼r
    return new { StatusCode = (int)response.StatusCode, ContentType = response.Content.Headers.ContentType?.ToString(), Content = content };
}
```



**ğŸ’» Dil:** `Python`

```python
import requests

def test_api_endpoint(api_url):
    response = requests.get(api_url)
    return {
        "status_code": response.status_code,
        "content_type": response.headers.get("Content-Type"),
        "body": response.text
    }
```



**ğŸ’» Dil:** `TypeScript`

```typescript
import axios from 'axios';

export async function testApiEndpoint(apiUrl: string): Promise<any> {
    const res = await axios.get(apiUrl);
    return {
        statusCode: res.status,
        contentType: res.headers['content-type'],
        body: res.data
    };
}
```